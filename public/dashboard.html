<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SmartSummary - Tableau de bord</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <header>
      <div class="logo-container">
        <!-- SVG Logo inchangÃ© -->
        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" class="smart-summary-logo">
          <!-- ... ton SVG ... -->
        </svg>
        <h1>SmartSummary</h1>
      </div>
      <div class="nav-buttons">
        <!-- Liens relatifs corrigÃ©s -->
        <a href="record.html" class="nav-link">ğŸ™ï¸ Enregistrer</a>
        <a href="history.html" class="nav-link">ğŸ“š Historique</a>
        <a href="summaries.html" class="nav-link">ğŸ“ RÃ©sumÃ©s</a>
        <span id="adminLink" style="display: none;"><a href="admin.html" class="nav-link">âš™ï¸ Admin</a></span>
      </div>
      <div>
        <span id="currentUser"></span>
        <button id="logoutBtn">DÃ©connexion</button>
      </div>
    </header>

    <section class="card">
      <h2>ğŸ™ï¸ Enregistrement audio</h2>
      <div class="recorder">
        <button id="recordBtn">DÃ©marrer l'enregistrement</button>
        <button id="stopBtn" disabled>Stop</button>
        <span id="recStatus">Inactif</span>
      </div>
      <div class="player" id="playerArea"></div>
      <div class="upload">
        <button id="uploadBtn" disabled>TÃ©lÃ©verser l'audio</button>
        <progress id="uploadProgress" value="0" max="100" style="width:100%; display:none"></progress>
      </div>
      <div id="uploadResult" class="result" aria-live="polite"></div>
    </section>

    <section class="card">
      <h2>ğŸ“ RÃ©cupÃ©rer un rÃ©sumÃ©</h2>
      <p>Demander un rÃ©sumÃ© par email (optionnel).</p>
      <div class="summary">
        <label>Email destinataire
          <input id="summaryEmail" placeholder="Entrez email" />
        </label>
        <label>
          <input type="checkbox" id="sendEmailCheckbox" /> Envoyer par email
        </label>
        <button id="getSummary">Obtenir rÃ©sumÃ©</button>
        <pre id="summaryResult"></pre>
      </div>
    </section>

    <section class="card">
      <h2>ğŸ§  GÃ©nÃ©rer une carte mentale</h2>
      <p>GÃ©nÃ©rez une carte mentale basÃ©e sur votre enregistrement.</p>
      <div class="summary">
        <label>Email
          <input id="mindmapEmail" placeholder="Entrez votre email" />
        </label>
        <button id="getMindmap">Obtenir une carte mentale</button>
        <pre id="mindmapResult"></pre>
      </div>
    </section>
  </main>

  <script src="api.js"></script>
  <script src="auth-check.js"></script>
  <script src="app.js"></script>
  <script>
    // Affiche le nom de l'utilisateur connectÃ©
    const userJson = localStorage.getItem("smartsummary_user");
    if (userJson) {
      const user = JSON.parse(userJson);
      document.getElementById("currentUser").textContent = `ğŸ‘¤ ${user.name} (${user.role})`;
      // Affiche le lien admin si l'utilisateur est admin
      if (user.role === "admin") {
        document.getElementById("adminLink").style.display = "inline";
      }
    }

    // DÃ©connexion
    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("smartsummary_user");
      localStorage.removeItem("smartsummary_accessToken");
      localStorage.removeItem("smartsummary_refreshToken");
      window.location.href = "index.html";
    });
  </script>
</body>
</html>

